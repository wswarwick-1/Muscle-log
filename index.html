<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Training Log</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#111;
  color:#eee;
}
header{
  background:#000;
  padding:20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:bold;
  font-size:20px;
}
.gold{ color:#f2c94c; }

.container{ padding:20px; }

.card{
  background:#1c1c1c;
  padding:20px;
  margin-bottom:20px;
  border-radius:14px;
  box-shadow:0 4px 20px rgba(0,0,0,0.5);
}

select,input{
  width:100%;
  padding:12px;
  margin-top:10px;
  background:#111;
  border:1px solid #333;
  border-radius:8px;
  color:white;
}

button{
  width:100%;
  padding:14px;
  margin-top:15px;
  background:#f2c94c;
  border:none;
  border-radius:10px;
  font-weight:bold;
}

.log-workout{
  font-size:20px;
  margin-top:20px;
  color:#f2c94c;
}

.log-date{
  font-size:14px;
  margin-top:10px;
  color:#aaa;
}

.log-entry{
  background:#181818;
  padding:12px;
  margin-top:8px;
  border-radius:8px;
}

.pr-badge{
  background:#f2c94c;
  color:#000;
  padding:3px 8px;
  border-radius:6px;
  font-size:12px;
  margin-left:6px;
}
</style>
</head>
<body>

<header>
  Training Log
  <span class="gold" onclick="togglePage()">Log</span>
</header>

<div class="container" id="mainPage">

<div class="card">
  <label>Workout</label>
  <select id="workoutSelect"></select>
</div>

<div class="card">
  <label>Exercise</label>
  <select id="exerciseSelect"></select>
  <input id="customExercise" placeholder="Type custom exercise">
  <button onclick="useCustomExercise()">Use custom exercise</button>

  <p id="currentInfo">Current: —<br>PR: —<br>Last: —</p>
</div>

<div class="card">
  <label>Log Set</label>
  <input id="weight" type="number" placeholder="Weight (kg)">
  <input id="reps" type="number" placeholder="Reps">
  <button onclick="saveSet()">Save Set</button>
</div>

<div class="card">
  <label>Create Custom Workout</label>
  <input id="newWorkoutName" placeholder="Workout name">
  <input id="newExercise" placeholder="Exercise name">
  <button onclick="addExerciseToBuilder()">Add Exercise</button>
  <div id="builderPreview"></div>
  <button onclick="saveCustomWorkout()">Save Workout</button>
</div>

</div>

<div class="container" id="logPage" style="display:none"></div>

<script>

const DEFAULT_WORKOUTS={
  "Push":["Bench Press","Overhead Press","Incline DB Press","Lateral Raises","Tricep Pushdown"],
  "Pull":["Deadlift","Barbell Row","Lat Pulldown","Face Pull","Barbell Curl"],
  "Legs":["Squat","Romanian Deadlift","Leg Press","Hamstring Curl","Calf Raise"],
  "Powerlifting Program":["Squat","Bench Press","Deadlift"]
};

let workouts;
let logs;
let prs;

function safeLoad(key, fallback){
  try{
    return JSON.parse(localStorage.getItem(key)) || fallback;
  }catch{
    return fallback;
  }
}

function init(){

  workouts = safeLoad("workouts", DEFAULT_WORKOUTS);
  if(Object.keys(workouts).length===0){
    workouts=DEFAULT_WORKOUTS;
    localStorage.setItem("workouts",JSON.stringify(workouts));
  }

  logs = safeLoad("logs", []);
  prs = safeLoad("prs", {});

  const workoutSelect=document.getElementById("workoutSelect");
  workoutSelect.innerHTML="";
  Object.keys(workouts).forEach(w=>{
    const opt=document.createElement("option");
    opt.value=w;
    opt.textContent=w;
    workoutSelect.appendChild(opt);
  });

  loadExercises();
}

function loadExercises(){
  const workout=document.getElementById("workoutSelect").value;
  const exerciseSelect=document.getElementById("exerciseSelect");
  exerciseSelect.innerHTML="";
  workouts[workout].forEach(ex=>{
    const opt=document.createElement("option");
    opt.value=ex;
    opt.textContent=ex;
    exerciseSelect.appendChild(opt);
  });
  updateInfo();
}

function useCustomExercise(){
  const val=document.getElementById("customExercise").value.trim();
  if(!val)return;
  const select=document.getElementById("exerciseSelect");
  const opt=document.createElement("option");
  opt.value=val;
  opt.textContent=val;
  select.appendChild(opt);
  select.value=val;
  document.getElementById("customExercise").value="";
  updateInfo();
}

function updateInfo(){
  const ex=document.getElementById("exerciseSelect").value;
  const last=logs.filter(l=>l.exercise===ex).slice(-1)[0];
  const pr=prs[ex];

  document.getElementById("currentInfo").innerHTML=
    `Current: ${ex}<br>
     PR: ${pr? pr.weight+"kg x "+pr.reps:"—"}<br>
     Last: ${last? last.weight+"kg x "+last.reps:"—"}`;
}

function saveSet(){
  const workout=document.getElementById("workoutSelect").value;
  const exercise=document.getElementById("exerciseSelect").value;
  const weight=parseFloat(document.getElementById("weight").value);
  const reps=parseInt(document.getElementById("reps").value);
  if(!weight||!reps)return;

  const today=new Date().toISOString().split("T")[0];

  logs.push({workout,exercise,weight,reps,date:today});
  localStorage.setItem("logs",JSON.stringify(logs));

  if(!prs[exercise]||weight>prs[exercise].weight){
    prs[exercise]={weight,reps};
    localStorage.setItem("prs",JSON.stringify(prs));
  }

  document.getElementById("weight").value="";
  document.getElementById("reps").value="";
  updateInfo();
}

function togglePage(){
  const main=document.getElementById("mainPage");
  const log=document.getElementById("logPage");
  if(main.style.display==="none"){
    main.style.display="block";
    log.style.display="none";
  }else{
    main.style.display="none";
    log.style.display="block";
    renderLog();
  }
}

function renderLog(){
  const container=document.getElementById("logPage");
  container.innerHTML="";

  if(logs.length===0){
    container.innerHTML="<p>No logs yet</p>";
    return;
  }

  const grouped={};

  logs.forEach(l=>{
    if(!grouped[l.workout])grouped[l.workout]={};
    if(!grouped[l.workout][l.date])grouped[l.workout][l.date]=[];
    grouped[l.workout][l.date].push(l);
  });

  Object.keys(grouped).reverse().forEach(workout=>{
    container.innerHTML+=`<div class="log-workout">${workout}</div>`;
    Object.keys(grouped[workout]).reverse().forEach(date=>{
      container.innerHTML+=`<div class="log-date">${date}</div>`;
      grouped[workout][date].forEach(l=>{
        const isPR=prs[l.exercise] && prs[l.exercise].weight===l.weight;
        container.innerHTML+=`
          <div class="log-entry">
            ${l.exercise} — ${l.weight}kg x ${l.reps}
            ${isPR?'<span class="pr-badge">PR</span>':''}
          </div>`;
      });
    });
  });
}

let builder=[];

function addExerciseToBuilder(){
  const ex=document.getElementById("newExercise").value.trim();
  if(!ex)return;
  builder.push(ex);
  document.getElementById("newExercise").value="";
  document.getElementById("builderPreview").innerHTML=
    builder.map((e,i)=>`${i+1}. ${e}`).join("<br>");
}

function saveCustomWorkout(){
  const name=document.getElementById("newWorkoutName").value.trim();
  if(!name||builder.length===0)return;
  workouts[name]=[...builder];
  localStorage.setItem("workouts",JSON.stringify(workouts));
  builder=[];
  document.getElementById("builderPreview").innerHTML="";
  document.getElementById("newWorkoutName").value="";
  init();
}

document.getElementById("workoutSelect").onchange=loadExercises;
document.getElementById("exerciseSelect").onchange=updateInfo;

init();

</script>

</body>
</html>
