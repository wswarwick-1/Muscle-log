<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Muscle Log</title>

<style>
body {
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background:#2f2f2f;
  color:#f5f5f5;
}
header {
  background:#1f1f1f;
  padding:14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
a { color:#f2c94c; text-decoration:none; }

h1 {
  text-align:center;
  color:#f2c94c;
  margin:16px 0;
}

.container {
  max-width:520px;
  margin:auto;
  padding:12px;
}

.card {
  background:#3a3a3a;
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
}

button {
  width:100%;
  padding:14px;
  border-radius:16px;
  border:none;
  background:#444;
  color:#f2c94c;
  font-size:16px;
  margin-top:8px;
}

.exercise {
  padding:10px;
  margin-top:6px;
  border-radius:12px;
  background:#2b2b2b;
}
.exercise.active {
  background:#f2c94c;
  color:#000;
}

input, select {
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:14px;
  border:none;
  background:#2b2b2b;
  color:#fff;
  font-size:15px;
}

.small { font-size:13px; opacity:.85; }
.highlight { color:#f2c94c; font-weight:600; }
.center { text-align:center; }
</style>
</head>

<body>

<header>
  <div>Muscle Log</div>
  <a href="log.html">Log</a>
</header>

<h1>Muscle Log</h1>

<div class="container">

<!-- STATUS -->
<div class="card">
  <div class="highlight">Current Exercise</div>
  <div id="currentExercise">None</div>
  <div class="small">PR: <span id="prDisplay">â€”</span></div>
  <div class="small">Set: <span id="setCount">0</span></div>
</div>

<!-- WORKOUT SELECT -->
<div class="card">
  <div class="highlight">Workout</div>
  <select id="workoutSelect" onchange="loadWorkout()"></select>
  <div id="exerciseList"></div>
</div>

<!-- LOG SET -->
<div class="card">
  <div class="highlight">Log Set</div>
  <div class="small" id="lastTime">Last time: â€”</div>
  <input id="weight" type="number" placeholder="Weight (kg)">
  <input id="reps" type="number" placeholder="Reps">
  <button id="saveSetBtn">Save Set</button>
</div>

<!-- REST TIMER -->
<div class="card center">
  <div class="highlight">Rest Timer</div>
  <input id="restInput" type="number" value="90">
  <div id="timer" style="font-size:28px;margin:10px 0;">00:00</div>
  <button id="startTimerBtn">Start</button>
  <button id="resetTimerBtn">Reset</button>
</div>

<!-- BUILD WORKOUT -->
<div class="card">
  <div class="highlight">Build Workout</div>
  <input id="newWorkoutName" placeholder="Workout name">
  <input id="newExerciseName" placeholder="Add exercise">
  <button id="addExerciseBtn">Add Exercise</button>
  <div id="builderPreview" class="small"></div>
  <button id="saveWorkoutBtn">Save Workout</button>
</div>

</div>

<script>
/* ---------- DATA ---------- */
const DEFAULT_WORKOUTS = {
  "Upper Body": ["Bench Press","Row","OHP","Pull-ups","Triceps"],
  "Lower Body": ["Squat","RDL","Leg Press","Hamstring Curl","Calves"]
};

let workouts = JSON.parse(localStorage.getItem("workouts"));
if (!workouts) {
  workouts = DEFAULT_WORKOUTS;
  localStorage.setItem("workouts", JSON.stringify(workouts));
}

let logs = JSON.parse(localStorage.getItem("logs")) || [];
let prs = JSON.parse(localStorage.getItem("prs")) || {};

let currentWorkout = null;
let currentExercise = null;
let setCount = 0;
let builderBuffer = [];

/* ---------- ELEMENTS ---------- */
const workoutSelect = document.getElementById("workoutSelect");
const exerciseList = document.getElementById("exerciseList");
const currentExerciseEl = document.getElementById("currentExercise");
const prDisplay = document.getElementById("prDisplay");
const setCountEl = document.getElementById("setCount");

/* ---------- INIT ---------- */
function init() {
  workoutSelect.innerHTML = "";
  Object.keys(workouts).forEach(name => {
    const o = document.createElement("option");
    o.value = name;
    o.innerText = name;
    workoutSelect.appendChild(o);
  });
  loadWorkout();
}
init();

/* ---------- WORKOUT ---------- */
function loadWorkout() {
  currentWorkout = workoutSelect.value;
  exerciseList.innerHTML = "";
  currentExercise = null;
  setCount = 0;
  currentExerciseEl.innerText = "None";
  prDisplay.innerText = "â€”";
  setCountEl.innerText = "0";

  workouts[currentWorkout].forEach(ex => {
    const d = document.createElement("div");
    d.className = "exercise";
    d.innerText = ex;
    d.onclick = () => selectExercise(ex, d);
    exerciseList.appendChild(d);
  });
}

function selectExercise(ex, el) {
  currentExercise = ex;
  setCount = 0;
  currentExerciseEl.innerText = ex;
  setCountEl.innerText = "0";

  document.querySelectorAll(".exercise").forEach(e=>e.classList.remove("active"));
  el.classList.add("active");

  const pr = prs[ex];
  prDisplay.innerText = pr ? `${pr.weight}kg Ã— ${pr.reps}` : "â€”";
  updateLastTime(ex);
}

/* ---------- LOG SET ---------- */
document.getElementById("saveSetBtn").onclick = () => {
  if (!currentExercise) return alert("Select an exercise");

  const w = Number(weight.value);
  const r = Number(reps.value);
  if (!w || !r) return;

  setCount++;
  setCountEl.innerText = setCount;

  logs.push({
    date: new Date().toISOString().slice(0,10),
    workout: currentWorkout,
    exercise: currentExercise,
    weight: w,
    reps: r
  });
  localStorage.setItem("logs", JSON.stringify(logs));

  const existing = prs[currentExercise];
  if (!existing || w > existing.weight || (w === existing.weight && r > existing.reps)) {
    prs[currentExercise] = { weight:w, reps:r };
    localStorage.setItem("prs", JSON.stringify(prs));
    prDisplay.innerText = `${w}kg Ã— ${r}`;
  }

  weight.value = reps.value = "";
};

/* ---------- TIMER ---------- */
let timerInterval;
document.getElementById("startTimerBtn").onclick = () => {
  clearInterval(timerInterval);
  let t = Number(restInput.value);
  updateTimer(t);
  timerInterval = setInterval(()=>{
    t--;
    updateTimer(t);
    if (t <= 0) {
  clearInterval(timerInterval);

  // ðŸ“³ VIBRATE (if supported)
  if (navigator.vibrate) {
    navigator.vibrate([300, 150, 300]);
  }

  // ðŸ”” BEEP
  const beep = document.getElementById("beep");
  beep.currentTime = 0;
  beep.play().catch(() => {});
    }
};
document.getElementById("resetTimerBtn").onclick = () => {
  clearInterval(timerInterval);
  updateTimer(0);
};
function updateTimer(t) {
  const m = String(Math.floor(t/60)).padStart(2,"0");
  const s = String(t%60).padStart(2,"0");
  timer.innerText = `${m}:${s}`;
}

/* ---------- BUILDER ---------- */
document.getElementById("addExerciseBtn").onclick = () => {
  const ex = newExerciseName.value.trim();
  if (!ex) return;
  builderBuffer.push(ex);
  newExerciseName.value = "";
  builderPreview.innerHTML = builderBuffer.map((e,i)=>`${i+1}. ${e}`).join("<br>");
};

document.getElementById("saveWorkoutBtn").onclick = () => {
  const name = newWorkoutName.value.trim();
  if (!name || builderBuffer.length === 0) return alert("Name + exercises");

  workouts[name] = [...builderBuffer];
  localStorage.setItem("workouts", JSON.stringify(workouts));

  builderBuffer = [];
  newWorkoutName.value = "";
  builderPreview.innerHTML = "";
  init();
};
  function updateLastTime(exercise) {
  const last = [...logs]
    .reverse()
    .find(l => l.exercise === exercise);

  document.getElementById("lastTime").innerText = last
    ? `Last time: ${last.weight}kg Ã— ${last.reps}`
    : "Last time: â€”";
  }
</script>
<audio id="beep">
  <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=" type="audio/wav">
</audio>
</body>
</html>



